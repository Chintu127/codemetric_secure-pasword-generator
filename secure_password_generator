import random
import string

try:
    import pyperclip   # optional (for copy to clipboard)
    CLIPBOARD_AVAILABLE = True
except ImportError:
    CLIPBOARD_AVAILABLE = False


def generate_password(length=12, use_upper=True, use_lower=True, use_digits=True, use_special=True, copy_to_clipboard=False):
    # Character sets
    upper = string.ascii_uppercase if use_upper else ""
    lower = string.ascii_lowercase if use_lower else ""
    digits = string.digits if use_digits else ""
    special = string.punctuation if use_special else ""

    # Ensure at least one type is chosen
    if not (upper + lower + digits + special):
        raise ValueError("No character types selected! Please enable at least one.")

    # Build pool of allowed characters
    all_chars = upper + lower + digits + special

    # Generate random password
    password = ''.join(random.choice(all_chars) for _ in range(length))

    # Ensure password contains at least one of each selected type
    while (use_upper and not any(c.isupper() for c in password)) or \
          (use_lower and not any(c.islower() for c in password)) or \
          (use_digits and not any(c.isdigit() for c in password)) or \
          (use_special and not any(c in string.punctuation for c in password)):
        password = ''.join(random.choice(all_chars) for _ in range(length))

    # Copy to clipboard if requested and pyperclip is available
    if copy_to_clipboard and CLIPBOARD_AVAILABLE:
        pyperclip.copy(password)

    return password


# Main program
if __name__ == "__main__":
    try:
        length = int(input("Enter password length (number only): "))
    except ValueError:
        print("❌ Please enter a valid number for password length!")
        exit()

    pwd = generate_password(length=length, copy_to_clipboard=True)

    print("\n✅ Generated Password:", pwd)
    if CLIPBOARD_AVAILABLE:
        print("(Password has also been copied to clipboard!)")
    else:
        print("(Install pyperclip if you want auto-copy feature)")
